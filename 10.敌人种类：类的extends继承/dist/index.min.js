var __extends=this&&this.__extends||function(){var s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();window.addEventListener("load",function(){var t=document.querySelector("#myCanvas"),e=document.querySelector("#collisionLayer"),i=t.getContext("2d");e.getContext("2d"),t.width=e.width=1024,t.height=e.height=760;function h(t,e){return Math.random()*(e-t)+t}var s=(a.prototype.update=function(t){this.addEnemy(t),this.removeDieEnemys()},a.prototype.draw=function(e){this.Context2D.clearRect(0,0,this.CANVAS_WIDTH,this.CANVAS_HEIGHT),this.enemys.forEach(function(t){return t.refresh(e)})},a.prototype.refresh=function(t){this.update(t),this.draw(t)},a.prototype.addEnemy=function(t){this.addEnemyTimer+=t,500<this.addEnemyTimer&&(this.addEnemyTimer=0,this.enemys.push(new l(this)),this.enemys.push(new u(this)),this.enemys.push(new A(this)))},a.prototype.removeDieEnemys=function(){this.enemys=this.enemys.filter(function(t){return t.isAlive()})},a);function a(t,e,i){this.addEnemyTimer=0,this.Context2D=t,this.CANVAS_WIDTH=e,this.CANVAS_HEIGHT=i,this.enemys=[]}var n=(o.prototype.update=function(t){},o.prototype.animate=function(t){this.animateframeIndex=Math.floor(this.animateframeCount++/this.animateframeStage)%this.imgframeTotal,this.Game.Context2D.drawImage(this.img,this.animateframeIndex*this.imgframeWidth,0,this.imgframeWidth,this.imgframeHeight,this.posX,this.posY,this.drawWidth,this.drawHeight)},o.prototype.refresh=function(t){this.update(t),this.animate(t)},o);function o(t,e,i,s,a,n){this.posX=0,this.posY=0,this.animateframeIndex=0,this.animateframeCount=0,this.animateframeStage=3,this.Game=t,this.img=new Image,this.img.src=e,this.imgframeTotal=i,this.imgframeWidth=s,this.imgframeHeight=a,this.drawWidth=this.imgframeWidth*n,this.drawHeight=this.imgframeHeight*n,this.animateframeStage=Math.floor(h(3,8))}var r,m=(__extends(p,r=n),p);function p(){var t=null!==r&&r.apply(this,arguments)||this;return t.moveSpeedX=0,t.moveSpeedY=0,t}var d,u=(__extends(f,d=m),f.prototype.isAlive=function(){return 0<this.posX+this.drawWidth},f.prototype.move=function(t){this.posX-=this.moveSpeedX*t},f.prototype.update=function(t){this.move(t)},f);function f(t){var e=d.call(this,t,"./imgs/Worm.png",6,229,171,.5)||this;return e.posX=e.Game.CANVAS_WIDTH,e.posY=e.Game.CANVAS_HEIGHT-e.drawHeight,e.moveSpeedX=h(.1,.2),e}var c,l=(__extends(g,c=m),g.prototype.isAlive=function(){return 0<this.posX+this.drawWidth},g.prototype.move=function(t){this.posX-=this.moveSpeedX*t},g.prototype.shake=function(t){this.posY+=this.shakeGapRadius*Math.sin(this.shakeAngle),this.shakeAngle+=this.shakeDeltaAngle*t},g.prototype.update=function(t){this.move(t),this.shake(t)},g.prototype.animate=function(t){this.Game.Context2D.save(),this.Game.Context2D.globalAlpha=this.alpha,c.prototype.animate.call(this,t),this.Game.Context2D.restore()},g);function g(t){var e=c.call(this,t,"./imgs/Ghost.png",6,261,209,.5)||this;return e.shakeAngle=0,e.posX=e.Game.CANVAS_WIDTH,e.posY=.5*h(0,e.Game.CANVAS_HEIGHT-e.drawHeight),e.moveSpeedX=h(.2,.3),e.alpha=h(.2,.5),e.shakeAngle=h(Math.asin(-1),Math.asin(1)),e.shakeDeltaAngle=h(Math.asin(.001),Math.asin(.003)),e.shakeGapRadius=h(2,5),e}var y,A=(__extends(v,y=m),v.prototype.isAlive=function(){return this.shakeAngle<=Math.PI},v.prototype.shake=function(t){this.posY=this.shakePosY+this.shakeGapRadius*Math.sin(this.shakeAngle),this.shakeAngle+=this.shakeDeltaAngle*t},v.prototype.move=function(t){this.shake(t)},v.prototype.update=function(t){this.move(t)},v.prototype.animate=function(t){this.Game.Context2D.beginPath(),this.Game.Context2D.moveTo(this.posX+this.drawWidth/2,0),this.Game.Context2D.lineTo(this.posX+this.drawWidth/2,this.posY),this.Game.Context2D.stroke(),y.prototype.animate.call(this,t)},v);function v(t){var e=y.call(this,t,"./imgs/Spider.png",6,310,175,.5)||this;return e.shakeAngle=0,e.posX=h(0,e.Game.CANVAS_WIDTH-e.drawWidth),e.posY=-e.drawHeight,e.shakePosY=e.posY,e.shakeAngle=0,e.shakeDeltaAngle=h(Math.asin(5e-4),Math.asin(.001)),e.shakeGapRadius=h(e.Game.CANVAS_HEIGHT/4,e.Game.CANVAS_HEIGHT),e}var _=new s(i,1024,760),G=0;!function t(e){var i=e-G;G=e,_.refresh(i),requestAnimationFrame(t)}(0)});